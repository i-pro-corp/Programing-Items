<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="kinoshita hidetoshi (木下 英俊)">
  <meta name="description" content="木下英俊が自身のためにプログラムメモを残すことを目的に作成したページです。">
  <meta name="keywords" content="">
  <!-- キャッシュ無効化 -->
  <meta http-equiv="Cache-Control" content="no-cache">
	
  <!-- タイトル -->
  <title>Pytorch をインストールする | i-PRO - Programming Items</title>
	
  <!-- ファビコン -->
  <link rel="shortcut icon" href="../favicon.ico">
  
  <!-- CSS -->
  <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../design.css" type="text/css">
  
	<!-- Start for 'google-code-prettify' -->
	<link href="../prettify/styles/desert.css" rel="stylesheet" type="text/css">
	<script src="../prettify/prettify.js" type="text/javascript"></script>
	<!-- End for 'google-code-prettify' -->	
	
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5DFRG3H0KB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5DFRG3H0KB');
  </script>  
  <!-- Global site tag (gtag.js) - Google Analytics -->

  <style type="text/css">
  .auto-style2 {
	text-decoration: underline;
  }
  .auto-style3 {
	background-color: #505000;
  }
  </style>

</head>

<body onload="prettyPrint();">
	
<h1>Pytorch をインストールする</h1>
<p>&nbsp;</p>
<div class="status_information">
  <div>
  </div>
  <div>
    <p>本ページは i-PRO株式会社 の有志メンバーにより記載されたものです。<br>本ページの情報は <a href="#ライセンス">ライセンス</a> に記載の条件で提供されます。</p>
  </div>
</div>

<p>&nbsp;</p>
<div class="mokuji">
  <nav>
	<h2>目次</h2>
	<p><a href="#1._Windows">1. Windows</a></p>
	<p>&nbsp; <a href="#1-1._CPU">1-1. CPU</a></p>
	<p>&nbsp; <a href="#1-2._CUDA">1-2. CUDA&nbsp;</a></p>
	<p>&nbsp;</p>
	<p><a href="#ライセンス">ライセンス</a></p>
	<p><a href="#参考">参考</a></p>
  </nav>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>

<section>
	<h2> <a name="1._Windows">1. Windows</a></h2>
	
<section>
	<h3> <a name="1-1._CPU">1-1. CPU</a></h3>
	<p> &nbsp;</p>
	<h4>[概要]</h4>
	<p>Windows 環境へ Pytorch をインストールする手順、注意事項、などを本ページにまとめます。</p>
    <p>こちらでは "Compute Platform" として "CPU" を選択してインストールする手順について記載します。NVIDIA の GPU 
    など特定のハードウェアを必要としないので、多くの Windows 環境で適用可能です。</p>
	<p> &nbsp;</p>
	
	<h4>[環境]</h4>
	<table>
	<tbody>
	  <tr>
	    <td class="td_separate" colspan="3"></td>
	  </tr>
		
	  <tr>
	    <td>OS :</td>
	    <td>Windows11 home,</td>
	    <td>22H2</td>
	  </tr>
	  
	  <tr>
	    <td class="td_separate" colspan="3"></td>
	  </tr>
	</tbody>
	</table>
	
	<p> &nbsp;</p>
	
	<h4>[手順]</h4>
  <p> (1)</p>
  <p> 下記URLを開きます。</p>
  <p> <a href="https://pytorch.org/get-started/locally/" target="_blank">
  https://pytorch.org/get-started/locally/</a></p>
  <p>&nbsp;</p>
  <p> (2)</p>
  <p> 下図のような画面を表示するので、使用する環境を選択します。ここでは下記項目を選択します。</p>
	<ul>
	  <li>PyTorch Build： <strong>Stable(1.11.0)</strong></li>
	  <li>Your OS： <strong>Windows</strong></li>
	  <li>Package： <strong>Pip</strong></li>
	  <li>Language： <strong>Python</strong></li>
	  <li>Computer Platform： <strong>CPU</strong></li>
	</ul>
	<p> commandは <span class="cpp-source">pip3 install torch torchvision torchaudio</span> となりました。</p>
	<p> &nbsp;</p>
	<p>
	<img alt="PyTorch ホームページ画面１" class="border_with_drop-shadow" src="install_pytorch/img6.jpg" width="800"></p>
	<p> 
	<a href="connect_surveillance_camera/mobilenet-ssd/img5.jpg" target="_blank">
  <img alt="PyTorch ホームページ画面２" class="border_with_drop-shadow" src="install_pytorch/img5.jpg" width="800"></a></p>
  <p>&nbsp;</p>
	<p>ちなみに "CUDA 11.3" を選択すると <span class="cpp-source">pip3 install torch 
  torchvision torchaudio --extra-index-url 
  https://download.pytorch.org/whl/cu113</span> となりました。</p>
	<p>&nbsp;</p>
  <p> (3)</p>
  <p> 表示されたコマンドをコマンドプロンプトなどのターミナルから入力することで Pytorch をインストールします。</p>
	<p> &nbsp;</p>
	<p> 
	<a href="connect_surveillance_camera/image_classification_vgg/img7.gif" target="_blank">
  <img alt="PyTorch インストール画面１" class="border_with_drop-shadow" src="install_pytorch/img7.gif" width="800"></a></p>
	<p> &nbsp;</p>
	<p> 
	<a href="connect_surveillance_camera/image_classification_vgg/img9.jpg" target="_blank">
  <img alt="PyTorch インストール画面２" class="border_with_drop-shadow" src="install_pytorch/img9.jpg" width="800"></a></p>
	<p> &nbsp;</p>
	<p> 
	<a href="connect_surveillance_camera/image_classification_vgg/imgD.gif" target="_blank">
  <img alt="PyTorch インストール画面３" class="border_with_drop-shadow" src="install_pytorch/imgD.gif" width="800"></a></p>
  <p>&nbsp;</p>
  <p> これで Pytorch のインストールを完了です。</p>
  <p> &nbsp;</p>
  <p> (4)</p>
  <p> インストールされている Pytorch のバージョンを確認したい場合、以下の手順で確認できます。</p>
  <p> コマンドプロンプトなどのターミナルから python を起動し、"import torch" した後に 
  "print(torch.__version__)" するだけです。</p>

  <pre style="background-color: #000000; color: #C0C0C0; width: 800px; overflow-x: auto;">Microsoft Windows [Version 10.0.22621.1194]
(c) Microsoft Corporation. All rights reserved.

C:\Users\foo&gt;<span class="auto-style3">python</span>
Python 3.10.7 (tags/v3.10.7:6cc6b13, Sep  5 2022, 14:08:36) [MSC v.1933 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; <span class="auto-style3">import torch</span>
&gt;&gt;&gt; <span class="auto-style3">print(torch.__version__)</span>
1.11.0+cpu
&gt;&gt;&gt;</pre>

  <p> &nbsp;</p>
</section>
	
<p> &nbsp;</p>
<hr>
<p> &nbsp;</p>
	
<section>
	<h3> <a name="1-2._CUDA">1-2. CUDA</a></h3>
	<p> &nbsp;</p>
	<h4>[概要]</h4>
	<p>Windows 環境へ Pytorch をインストールする手順、注意事項、などを本ページにまとめます。</p>
  <p>こちらでは "Compute Platform" として "CUDA" を選択してインストールする手順について記載します。NVIDIA の GPU 
  を必要とします。</p>
	<p>&nbsp;</p>
	
	<h4>[環境]</h4>
	<table>
	<tbody>
	  <tr>
	    <td class="td_separate" colspan="3"></td>
	  </tr>
		
	  <tr>
	    <td>OS :</td>
	    <td>Windows11,</td>
	    <td>22H2</td>
	  </tr>
	  
	  <tr>
	    <td class="td_separate" colspan="3"></td>
	  </tr>
	</tbody>
	</table>
	
	<p> &nbsp;</p>
	
	<h4>[手順]</h4>
    
  <div class="status_ok">
    <div></div>
    <div>
      <p><strong>ポイント</strong></p>
      <p>Tytorch を GPU(CUDA) 環境としてインストールする場合、下記４つの条件を合わせる必要があります。</p>
      <p>・NVIDIA の GPUドライバー</p>
      <p>・CUDA toolkit</p>
      <p>・cuDNN</p>
      <p>・Pytorch&nbsp;</p>
    </div>
  </div>

  <p> &nbsp;</p>
  <p> (1) NVIDIA GPU ドライバーインストール、更新</p>
  <p> CUDA は NVIDIA社製のGPU環境で使用できます。まずは使用されるPCのGPUドライバを最新版へアップデートしましょう。</p>
  <p> <a href="https://www.nvidia.com/ja-jp/geforce/drivers/">GeForce 公式ドライバー (nvidia.com)</a></p>
  <p> "Geforce Experience" をインストールしておくと NVIDIA から新しいドライバーのリリースが自動的に通知されて便利かもしれません。</p>
  <p> &nbsp;</p>
	<p> (2)</p>
	<p> "CUDA Toolkit" を Visual Studio と共に使用する人は、先に Visual Studio をインストールしておきます。"CUDA 
	Toolkit" をインストールする際に "Visual Studio Integration" というコンポーネントをインストールしますが、事前に 
	Visual Studio をインストールしておかないと "Visual Studio Integration" 
	のインストールを失敗してしまうからです。</p>
	<p> Visual Studio を使用しない人は次へ進みますが、"CUDA Toolkit" をインストールする際に「カスタム インストール 
	オプション」画面のツリーから「CUDA」を展開し、その中にある「<strong>Visual Studio Integration</strong>」の項目の<strong>チェックを外す</strong>必要があります。</p>
	<p> &nbsp;</p>
	<p> (3)</p>
  <p> 下記URLを開きます。</p>
  <p> <a href="https://pytorch.org/get-started/locally/" target="_blank">
  https://pytorch.org/get-started/locally/</a></p>
    <p> &nbsp;</p>
	<p> "Computer Platform" の欄を確認して、動作する CUDA バージョンを確認します。</p>
	<p> 下図例だと "CUDA 11.6" または "CUDA 11.7" をインストールする必要があることを意味します。</p>
    <p> 以下、"CUDA 11.7" をインストールするというシナリオで説明します。</p>
	<p>  
	<img alt="Pytorch インストール" src="install_pytorch/img61.jpg" width="800" class="border"></p>
	<p> &nbsp;</p>
	<p> (4) "CUDA Toolkit" をダウンロード</p>
	<p> "CUDA Toolkit" をダウンロードします。<a href="https://developer.nvidia.com/cuda-downloads" target="_blank">CUDA Toolkit Downloads | NVIDIA Developer</a> へアクセスします。</p>
	<p> 最新版をダウンロードする、で良い場合は下図から適切な条件を選択してダウンロードします。</p>
	<p> 
	<img alt="CUDA Toolkit Download" src="install_pytorch/img59.jpg" width="800"></p>
	<p> 
	<span class="auto-style2"><strong>過去のバージョン</strong></span>をダウンロードする場合、画面下段にある 
	Archive of Previous CUDA Releases をクリックすると、過去の "CUDA Toolkit" 
	をダウンロードできるページへ移動します。こちらから目的の OS およびバージョンの "CUDA Toolkit" をダウンロードします。 </p>
    <p> 
	<img alt="Archive of Previous CUDA Release" src="install_pytorch/img3.jpg" width="800"></p>
    <p> 
	&nbsp;</p>
    <p> 
	本例では下記「CUDA Toolkit 11.7.1」をクリックしてインストーラをダウンロードします。</p>
    <p> 
	<img alt="CUDA Toolkit Archive" class="border_with_drop-shadow" src="install_pytorch/img4.jpg" width="800"></p>
	<p> 
	&nbsp;</p>
	<p> (5) "CUDA Toolkit" をインストール</p>
	<p> ダウンロードした "CUDA Toolkit" 
	を実行します。ライセンス条項についての確認があるので、内容を読んで［同意して続行する(A)］をクリックします。</p>
  <p><img alt="NVIDIA インストーラー" src="install_pytorch/img7.jpg" width="800"></p>
	<p>&nbsp;</p>
	<p> インストールオプションで高速（推奨）とカスタム（詳細）を選択画面になります。 </p>
	<p> <span class="auto-style2">"Visual Studio" をインストールしていない場合</span>、インストールオプションの画面で「カスタム 
	(詳細)(C)」を選択して［次へ(N)］をクリックします。</p>
	<p> 特に指定をする必要がない場合は［高速 (推奨)(E)］を選んで［次へ(N)］をクリックします。</p>
	<p> 
    <img alt="インストール オプション" src="install_pytorch/img8.jpg" width="800">&nbsp;</p>
	<p> &nbsp;</p>
	<p> <span class="auto-style2">"Visual Studio" をインストールしていない場合</span>、「カスタム 
	インストール オプション」画面のツリーから「CUDA」を展開し、その中にある「<strong>Visual 
	Studio Integration</strong>」の項目の<strong>チェックを外す</strong>必要があります。</p>
	<p> チェックを外したら［次へ(N)］をクリックします。</p>
	<p> 
	<img alt="カスタム インストール オプション" src="install_pytorch/imgA.jpg" width="800">&nbsp;</p>
	<p> &nbsp;</p>
	<p> 「インストールの場所」はデフォルトで問題ありません。あとは画面の指示に従って［次へ(N)］などをクリックしていきます。</p>
	<p> CUDAのインストールが開始して、無事にインストールを完了すると「NVIDIA インストーラーが終了しました」と画面へ表示します。［閉じる］を押して、CUDAのインストールを完了です。</p>
	<p> &nbsp;</p>
	<p> (6) "cuDNN" をインストール</p>
	<p> <a href="https://developer.nvidia.com/rdp/cudnn-download">https://developer.nvidia.com/rdp/cudnn-download</a> 
	へアクセスします。NVIDIA へユーザー登録する必要があります。</p>
	<p>インストールした CUDA のバージョンによって、ダウンロードするファイルが異なります。最新版の cuDNN ではなく古い cuDNN 
	を欲しい場合は「Archived cuDNN Releases」をクリックしてここから探します。</p>
	<p>&nbsp;</p>
	<p>
	<img alt="cuDNN インストール" src="install_pytorch/img5F.jpg" width="800" class="border"></p>
	<p>&nbsp;</p>
	<p>&nbsp;</p>
	<p>ダウンロードしたファイルを解凍したら、cuDNN 内の cuda フォルダの中身すべてを任意のフォルダへ保存します。どこでも良いのですが、セットで使用する 
	CUDA フォルダの中にインストールすると管理の都合が良さそうです。ここでは 
	"C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\11.7\<strong>cuDNN</strong>" 
	というフォルダを作成してここへコピーすることとします。 </p>
	<p> &nbsp;</p>
	<p> (7) PATH を通す</p>
	<p> 下記５か所のパスを環境変数として登録します。インストーラにより自動的に登録されているものもあるかもしれませんが確認しましょう。</p>
	<ol>
	  <li>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7\bin</li>
	  <li>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7\libnvvp </li>
	  <li>C:\Program Files\NVIDIA GPU Computing 
	  Toolkit\CUDA\v11.7\extras\CUPTI\lib64 </li>
	  <li>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7\include </li>
	  <li>C:\Program Files\NVIDIA GPU Computing Toolkit\CUXA\v11.7\cuDNN </li>
	</ol>
	<p>&nbsp;</p>
	<p>これで CUDA のインストールと設定を完了です。</p>
	<p>&nbsp;</p>
	<p>(8)</p>
	<p>CUDA のバージョンに合う Pytorch をインストールします。</p>
  <p> 下記URLを開きます。</p>
  <p> <a href="https://pytorch.org/get-started/locally/" target="_blank">
  https://pytorch.org/get-started/locally/</a></p>
	<p> &nbsp;</p>
	<p> 自分の CUDA バージョンを選択して Pip コマンドを作成します。下図例では </p>
	<pre style="background-color: #000000; color: #C0C0C0; width: 800px; overflow-x: auto;">pip3 install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cu117</pre>
	となりました。
	<p> 
	<img alt="Pytorch インストール" src="install_pytorch/img61.jpg" width="800" class="border"></p>
	<p>&nbsp;</p>
	<p>このコマンドをコピペして Pytorch をインストールします。</p>
	<p>以上で Pytorch のインストールを完了です。動作確認を行う前に PC を再起動しておきましょう。</p>
	<p>&nbsp;</p>
	<p>(9)</p>
	<p>CUDA を有効化できていることを確認します。</p>
	<p>コマンドプロンプトなどのターミナルから python を起動し、"import torch" した後に 
  "print(torch.cuda.is_available())" し、結果が "True" となれば成功です。</p>

  <pre style="background-color: #000000; color: #C0C0C0; width: 800px; overflow-x: auto;">Microsoft Windows [Version 10.0.22621.1194]
(c) Microsoft Corporation. All rights reserved.

C:\Users\foo&gt;<span class="auto-style3">python</span>
Python 3.10.7 (tags/v3.10.7:6cc6b13, Sep  5 2022, 14:08:36) [MSC v.1933 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; <span class="auto-style3">import torch</span>
&gt;&gt;&gt; <span class="auto-style3">print(torch.cuda.is_available())</span>
True
&gt;&gt;&gt;</pre>

  <p>"False" となった場合はここまでの内容を再確認しましょう。</p>

  <p>&nbsp;</p>
  <p> (10)</p>
  <p> インストールされている Pytorch のバージョンを確認したい場合、以下の手順で確認できます。</p>
  <p> コマンドプロンプトなどのターミナルから python を起動し、"import torch" した後に 
  "print(torch.__version__)" するだけです。</p>

  <pre style="background-color: #000000; color: #C0C0C0; width: 800px; overflow-x: auto;">Microsoft Windows [Version 10.0.22621.1194]
(c) Microsoft Corporation. All rights reserved.

C:\Users\foo&gt;<span class="auto-style3">python</span>
Python 3.10.7 (tags/v3.10.7:6cc6b13, Sep  5 2022, 14:08:36) [MSC v.1933 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; <span class="auto-style3">import torch</span>
&gt;&gt;&gt; <span class="auto-style3">print(torch.__version__)</span>
1.13.1+cu117
&gt;&gt;&gt;</pre>

  <p> &nbsp;</p>
</section>
	
</section>
	
<p>&nbsp;</p>

<section>
  <h2><a id="ライセンス">ライセンス</a></h2>
  <p>本ページの情報は、特記無い限り下記ライセンスで提供されます。</p>
  <div class="license">
      <br>Copyright 2022 i-PRO Co., Ltd.<br><br>Licensed under the Apache License, Version 
      2.0 (the "License");<br>you may not use this file except in compliance with 
      the License.<br>You may obtain a copy of the License at <br><br>&nbsp;&nbsp;&nbsp;
      <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a><br><br>
      Unless required by 
      applicable law or agreed to in writing, software <br>distributed under the 
      License is distributed on an "AS IS" BASIS, <br>WITHOUT WARRANTIES OR 
      CONDITIONS OF ANY KIND, either express or implied. <br>See the License for 
      the specific language governing permissions and<br>limitations under the 
      License. <br> <br>
  </div>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
</section>


<br>

<section>
	<h2><a id="参考">参考</a></h2>
	<ul>
		<li>[1] PyTorch<br><a href="https://pytorch.org/" target="_blank">
      https://pytorch.org/</a></li>
		<li>[2] NVIDIA社GPUToolkit「CUDA」をインストールする方法まとめてみた | AIZINE（エーアイジン）<br>
		<a href="https://aizine.ai/cuda-install0323/" target="_blank">
		https://aizine.ai/cuda-install0323/</a></li>
		<li>[3] windows10でCUDA：GPUを使ってPyTorchを動かすためのポイント - Qiita<br>
		<a href="https://qiita.com/motoyuki1963/items/a334c9488c2f55a867cf" target="_blank">
		https://qiita.com/motoyuki1963/items/a334c9488c2f55a867cf</a></li>
		<li>[4]【Ubuntu】NVIDIAドライバ・CUDA・CUDNNをインストールして深層学習環境を整える – 茱萸note 
		(sakura.ne.jp)<br>
		<a href="https://guminote.sakura.ne.jp/archives/328" target="_blank">
		https://guminote.sakura.ne.jp/archives/328</a></li>
	</ul>
</section>

<p>&nbsp;</p>

<hr>

<p>&nbsp;</p>

<section>
	<h2 style="margin-bottom:5px">変更履歴</h2>
	<table>
	  <tr>
	    <td class="td_history_date">2023/3/1</td>
	    <td class="td_history_separator">-</td>
	    <td class="td_history">新規作成,</td>
	    <td class="td_history">木下英俊 </td>
	  </tr>
	</table>
</section>

<p>&nbsp;</p>

<section>
<p><a href="../index.html" target="_parent">i-PRO - Programming Items トップページ</a></p>
<p><a href="../privacy_policy.html">プライバシーポリシー</a></p>
</section>

<p>&nbsp;</p>

<footer>
	<p><small>&copy; 2023  i-PRO Co., Ltd.</small></p>
</footer>

</body>
</html>
